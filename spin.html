<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Prestige Aura ‚Äì Spin (Lite)</title>
<style>
  :root{--bg:#0b0b0f;--fg:#f7f7f7;--gold:#d4af37;--accent:#8b5cf6;--ok:#22c55e;--warn:#f59e0b;--muted:#9ca3af;}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  .wrap{max-width:720px;margin:0 auto;padding:16px 16px 28px}
  header{display:flex;align-items:center;justify-content:center;padding:8px 0 4px}
  .logo{width:42px;height:42px;border-radius:50%;background:#111;display:inline-flex;align-items:center;justify-content:center;font-weight:700;color:var(--gold);box-shadow:0 0 18px #000 inset, 0 0 6px #000}
  h1{font-size:18px;margin:10px 0 4px;text-align:center}
  .sub{font-size:12px;color:var(--muted);text-align:center;margin-bottom:10px}
  .card{border:1px solid #222;background:#111116;border-radius:12px;padding:12px;margin-top:12px}
  .row{display:flex;gap:10px;align-items:center;justify-content:space-between}
  .badge{display:inline-block;border:1px solid #2a2a2f;padding:4px 8px;border-radius:999px;font-size:12px;color:#ddd}
  .btn{border:1px solid #222;background:#141418;border-radius:10px;padding:12px 10px;font-weight:700;cursor:pointer;color:#fff}
  .btn.gold{background:linear-gradient(180deg,#3a2f13,#1f180a);border-color:#3a2c10;color:var(--gold)}
  .btn.accent{background:linear-gradient(180deg,#1a1630,#140f26);border-color:#251a49;color:#c7b8ff}
  .note{font-size:11px;color:var(--muted);margin-top:4px;display:block}
  .toast{position:fixed;right:12px;bottom:12px;background:#121217;border:1px solid #26262d;border-radius:10px;padding:10px 12px;font-size:12px;color:#eee;box-shadow:0 6px 24px rgba(0,0,0,.4)}
  .hide{display:none}
  /* wheel */
  .wheelWrap{position:relative;display:flex;align-items:center;justify-content:center;margin:16px 0}
  .pointer{position:absolute;top:-4px;width:0;height:0;border-left:12px solid transparent;border-right:12px solid transparent;border-bottom:18px solid var(--warn);filter:drop-shadow(0 2px 2px #000)}
  .wheel{width:280px;height:280px;border-radius:50%;border:6px solid #222;background:#222;display:grid;place-items:center;transition:transform 4.4s cubic-bezier(.19,.8,.2,1);overflow:hidden}
  .seg{position:absolute;inset:0;display:grid;place-items:center;font-size:12px;color:#e8e8ff}
  .seg span{display:block;transform:rotate(var(--rot)) translateY(-74px);text-align:center;width:110px}
  /* sheet */
  .modalBg{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:flex-end}
  .sheet{background:#101015;border-top-left-radius:14px;border-top-right-radius:14px;border:1px solid #222;width:100%;max-width:720px;margin:0 auto;padding:14px}
  .small{font-size:12px}
</style>
</head>
<body>
<div class="wrap">
  <header><div class="logo">PA</div></header>
  <h1 id="t-title">Everyone Can Win Free Gold & Luxury Replica Watches!</h1>
  <div class="sub" id="t-sub">Spin now. Low cost, high thrill.</div>

  <div class="card">
    <div class="row">
      <span class="badge" id="t-mode">üéØ Unlimited Draw</span>
      <span class="badge" id="inviteState">Invite 0 / 3</span>
    </div>
    <div class="wheelWrap">
      <div class="pointer"></div>
      <div class="wheel" id="wheel"></div>
    </div>
    <div class="row">
      <button class="btn gold" id="startBtn">üé∞ <span id="t-start">Start</span></button>
      <button class="btn accent" id="switchMode">üíé <span id="t-switch">Switch to Guaranteed</span></button>
    </div>
    <div class="note" id="t-note">Tip: Pay to reveal locked jackpot. Real-time verification.</div>
  </div>

  <div class="card">
    <div class="row"><div class="small" id="t-feed">Live feed</div><div class="small" id="priceBox"><span id="price">1</span> TON</div></div>
    <div class="small" id="feedBox">‚Äî</div>
    <div class="row" style="margin-top:8px">
      <button class="btn" id="copyInvite">üì£ <span id="t-invite">Invite Friends</span></button>
      <a class="btn" href="./index.html">üè† Home</a>
    </div>
  </div>
</div>

<div class="toast hide" id="toast"></div>

<!-- pay sheet -->
<div class="modalBg hide" id="payModal">
  <div class="sheet">
    <h3 id="t-pay-title">üéØ Jackpot locked ‚Äì complete payment</h3>
    <div class="small" id="payStatus">Waiting‚Ä¶</div>
    <div class="row" style="margin-top:10px">
      <button class="btn gold" id="createPay"><span id="t-pay-btn">Create payment</span></button>
      <button class="btn" id="closePay"><span id="t-close">Close</span></button>
    </div>
    <div class="small" id="t-pay-tip" style="margin-top:8px">
      If backend is not set, it will simulate success in ~6s.
    </div>
    <div class="small" id="invoiceBox" style="display:none"></div>
  </div>
</div>

<script>
/* i18n en+zh */
const i18n={en:{title:"Everyone Can Win Free Gold & Luxury Replica Watches!",sub:"Spin now. Low cost, high thrill.",mode_unl:"üéØ Unlimited Draw",mode_gtd:"üíé Guaranteed Win",start:"Start",switch:"Switch to Guaranteed",switchBack:"Switch to Unlimited",invite:"Invite Friends",note:"Tip: Pay to reveal locked jackpot. Real-time verification.",feed:"Live feed",pay_title:"üéØ Jackpot locked ‚Äì complete payment",pay_btn:"Create payment",close:"Close",pay_tip:"If backend is not set, it will simulate success in ~6s.",wheel:["THANKS","60% OFF","50% OFF","Lucky Gold","Pure Gold","Super Clone"],toasts:["won a Super Clone Watch worth $1000!","won Pure Gold Jewelry worth $500!","won a Lucky Charm Gold worth $300!"]},zh:{title:"‰∫∫‰∫∫ÈÉΩÂèØÁôΩÂ´ñÈªÑÈáëÂíåÈ°∂Á∫ßÂ§çÂàªÊâãË°®ÔºÅ",sub:"Áé∞Âú®Â∞±ÂºÄËΩ¨ÁõòÔºå‰ΩéÊàêÊú¨È´òÂà∫ÊøÄ„ÄÇ",mode_unl:"üéØ Êó†ÈôêÊäΩÂ•ñ",mode_gtd:"üíé ÁôæÂàÜÁôæ‰∏≠Â•ñ",start:"ÂºÄÂßãÊäΩÂ•ñ",switch:"ÂàáÊç¢Âà∞ÁôæÂàÜÁôæ‰∏≠Â•ñ",switchBack:"ÂàáÂõûÊó†ÈôêÊäΩÂ•ñ",invite:"ÈÇÄËØ∑Â•ΩÂèã",note:"ÊèêÁ§∫ÔºöÂÖàÈîÅÂÆöÂ§ßÂ•ñÔºåÊîØ‰ªòÂêéÂÆûÊó∂È™åËØÅÂπ∂ÂºÄÂ•ñ„ÄÇ",feed:"ÂÆûÊó∂Êí≠Êä•",pay_title:"üéØ Â§ßÂ•ñÂ∑≤ÈîÅÂÆö ‚Äì ËØ∑ÂÆåÊàêÊîØ‰ªò",pay_btn:"ÂàõÂª∫ÊîØ‰ªò",close:"ÂÖ≥Èó≠",pay_tip:"Ëã•Êú™ÈÖçÁΩÆÂêéÁ´ØÔºåÂ∞ÜÂú®Á∫¶ 6 ÁßíÂÜÖÊ®°ÊãüÊàêÂäü„ÄÇ",wheel:["Ë∞¢Ë∞¢ÊÉ†È°æ","60% ‰ºòÊÉ†Âà∏","50% ‰ºòÊÉ†Âà∏","ËΩ¨ËøêÈáë","Ë∂≥ÈáëÈ•∞ÂìÅ","Ë∂ÖÁ∫ßÂÖãÈöÜ"],toasts:["Ëé∑Âæó‰∫Ü‰ª∑ÂÄº $1000 ÁöÑË∂ÖÁ∫ßÂÖãÈöÜÊâãË°®ÔºÅ","Ëé∑Âæó‰∫Ü‰ª∑ÂÄº $500 ÁöÑË∂≥ÈáëÈ•∞ÂìÅÔºÅ","Ëé∑Âæó‰∫Ü‰ª∑ÂÄº $300 ÁöÑËΩ¨ËøêË∂≥ÈáëÈ•∞ÂìÅÔºÅ"]}};
const lang=(()=>{const tg=window.Telegram?.WebApp?.initDataUnsafe?.user?.language_code;const nav=(navigator.language||"en").slice(0,2).toLowerCase();const cand=(tg||nav||"en").toLowerCase();return i18n[cand]?cand:"en";})();
const L=i18n[lang];
function S(id,k){const el=document.getElementById(id);if(el)el.textContent=L[k];}
S("t-title","title");S("t-sub","sub");S("t-mode","mode_unl");S("t-start","start");S("t-switch","switch");S("t-invite","invite");S("t-note","note");S("t-feed","feed");S("t-pay-title","pay_title");S("t-pay-btn","pay_btn");S("t-close","close");S("t-pay-tip","pay_tip");

/* config */
const BASE_API=""; // ‚Üê ÂêéÁ´Ø /api Ê†πÔºõÁ©∫=‰º™Ê£ÄÊµã
const weekdays=[1,2,3,4,5];
const isWeekend=()=>![1,2,3,4,5].includes((new Date()).getDay());
const prices={unl:{wd:1,we:2}, gtd:[1,3,6,12,24]};
const state={mode:"unlimited",round:1,locked:null,paid:false};

/* price + wheel */
function price(){return state.mode==="unlimited"?(isWeekend()?prices.unl.we:prices.unl.wd):prices.gtd[Math.min(state.round-1,prices.gtd.length-1)];}
document.getElementById("price").textContent=String(price());
const wheel=document.getElementById("wheel");
function render(){wheel.innerHTML="";const n=L.wheel.length;for(let i=0;i<n;i++){const a=i*(360/n);const seg=document.createElement("div");seg.className="seg";seg.style.background=`conic-gradient(from ${a}deg, rgba(139,92,246,.18) 0 ${(360/n)/2}deg, rgba(0,0,0,0) ${(360/n)/2}deg ${360/n}deg)`;const lab=document.createElement("span");lab.style.setProperty("--rot",(a+360/n/2)+"deg");lab.textContent=L.wheel[i];seg.appendChild(lab);wheel.appendChild(seg);}}
render();

/* live feed (fake) */
(function(){const names=["@alex","@maria","@lihao","@john","@nina","@sam"];const box=document.getElementById("feedBox");const lines=L.toasts;function tick(){box.textContent=`${names[(Math.random()*names.length)|0]} ${lines[(Math.random()*lines.length)|0]}`;}tick();setInterval(tick,5000);})();

/* invite copy */
document.getElementById("copyInvite").onclick=async()=>{const id=window.Telegram?.WebApp?.initDataUnsafe?.user?.id || (Math.random()+"").slice(2,9);const link=location.origin+location.pathname+`?ref=${id}`;try{await navigator.clipboard.writeText(link);toast("Copied!")}catch{toast(link);}};

/* helpers */
const toastEl=document.getElementById("toast");function toast(s){toastEl.textContent=s;toastEl.classList.remove("hide");setTimeout(()=>toastEl.classList.add("hide"),2000);}
const payModal=document.getElementById("payModal");const payStatus=document.getElementById("payStatus");const invoiceBox=document.getElementById("invoiceBox");
function openPay(){payModal.classList.remove("hide");payStatus.textContent="Waiting‚Ä¶";invoiceBox.style.display="none";}
document.getElementById("closePay").onclick=()=>payModal.classList.add("hide");

/* spin mapping */
function lockPrize(){ if(state.mode==="unlimited"){const bag=["THANKS","COUPON60","THANKS","COUPON50","THANKS","LUCKY","THANKS","GOLD","THANKS","WATCH"];return bag[(Math.random()*bag.length)|0];} else {const path=["COUPON60","COUPON50","LUCKY","GOLD","WATCH"];return path[Math.min(state.round-1,path.length-1)];}}
function labelOf(code){switch(code){case"WATCH":return L.wheel[5];case"GOLD":return L.wheel[4];case"LUCKY":return L.wheel[3];case"COUPON50":return L.wheel[2];case"COUPON60":return L.wheel[1];default:return L.wheel[0];}}
function rotateTo(code){const idx=({"THANKS":0,"COUPON60":1,"COUPON50":2,"LUCKY":3,"GOLD":4,"WATCH":5}[code]??0);const per=360/6;const center=(idx*per)+per/2;const base=360*4;const off=360-center;const deg=base+off+(Math.random()*6-3);wheel.style.transform=`rotate(${deg}deg)`;}

/* buttons */
document.getElementById("switchMode").onclick=()=>{if(state.mode==="unlimited"){state.mode="guaranteed";document.getElementById("t-mode").textContent=L.mode_gtd;document.getElementById("t-switch").textContent=L.switchBack;state.round=1;}else{state.mode="unlimited";document.getElementById("t-mode").textContent=L.mode_unl;document.getElementById("t-switch").textContent=L.switch;state.round=1;}document.getElementById("price").textContent=String(price());};
document.getElementById("startBtn").onclick=()=>{state.locked=lockPrize();openPay();};

/* payment */
document.getElementById("createPay").onclick=async()=>{const amt=price(); if(!BASE_API){payStatus.textContent="Verifying on-chain‚Ä¶";invoiceBox.style.display="block";invoiceBox.textContent="(DEV) Simulating payment‚Ä¶";setTimeout(()=>{payStatus.textContent="finished";toast("üéâ "+labelOf(state.locked));state.round=Math.min(state.round+1,5);document.getElementById("price").textContent=String(price());payModal.classList.add("hide");},6000);return;}
try{const r=await fetch(BASE_API+"/create-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:amt,user_id:"webapp"})});const d=await r.json();invoiceBox.style.display="block";invoiceBox.innerHTML=`Payment link: <a target="_blank" href="${d?.invoice_url||'#'}">${d?.invoice_url||'open'}</a>`;payStatus.textContent="Verifying on-chain‚Ä¶";let n=0;(function poll(){fetch(`${BASE_API}/check-payment?invoice_id=${encodeURIComponent(d?.id||d?.order_id||"")}`).then(x=>x.json()).then(j=>{if((j?.payment_status||j?.status)==="finished"){payStatus.textContent="finished";toast("üéâ "+labelOf(state.locked));state.round=Math.min(state.round+1,5);document.getElementById("price").textContent=String(price());payModal.classList.add("hide");}else if(++n<25)setTimeout(poll,3000);else payStatus.textContent="timeout";}).catch(()=>{if(++n<25)setTimeout(poll,3000);else payStatus.textContent="timeout";});})();}catch(e){invoiceBox.style.display="block";invoiceBox.textContent="Failed to create payment.";}
};
</script>
</body>
</html>
